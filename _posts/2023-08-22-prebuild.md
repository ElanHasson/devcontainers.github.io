---
layout: post
title:  "Speed Up Your Workflow with Prebuilds"
authors:
  - "@bamurtaugh"
  - "@craiglpeters"
authorUrls:
  - "https://github.com/bamurtaugh"
  - "https://github.com/craiglpeters"
---

Getting dev containers up and running for your projects is exciting - you've unlocked environments that include all the dependencies your projects need to run, and you can spend so much more time on coding rather than configuration. 

Once your dev container has everything it needs, you might start thinking more about ways to optimize it. For instance, it might take a while to build. Maybe it takes 5 minutes. Maybe it takes an hour! 

You can get back to working fast and productively after that initial container build, but what if you need to work on another machine and build the container again? Or what if some of your teammates want to use the container on their machines and will need to build it too? It'd be great to make the build time faster for everyone, every time.

After configuring your dev container, a great next step is to prebuild your image. In this guide, we'll explore what it means to prebuild an image and the benefits of doing so, such as speeding up your workflow, simplifying your environment, and pinning to specific versions of tools. We'll use a real example of a prebuilt image that [Craig](https://github.com/craiglpeters) developed for the [Kubernetes repo](https://github.com/craiglpeters/kubernetes-devcontainer).

## <a href="#what-is-a-prebuild" name="what-is-a-prebuild" class="anchor"> What is prebuilding? </a>

We should first define: What is prebuilding?

If you're already using dev containers, you're likely already familiar with the idea of building a container, where you package everything your app needs to run into a single unit. 

You'll need to build your container once it has all the dependencies it needs, and then you can continue using it. Since you may not need to rebuild often, it might be alright if it takes a while for that initial build. But if you or your teammates need to use that container on another machine, you'll need to wait for it to build it again in those new environments.

> **Note:** The [dev container CLI doc](/_implementors/reference.md#prebuilding) is another great resource on prebuilding.

### <a href="#prebuilt-codespaces" name="prebuilt-codespaces" class="anchor"> Prebuilt Codespaces </a>

You may have heard (or will hear about) GitHub Codespaces prebuilds.

// TODO: More info

## <a href="#how-to" name="how-to" class="anchor"> How do I prebuild my image? </a>

We try to make prebuilding an image and using a prebuilt image as easy as possible.

**Prebuilding an image:**
* Install the [Dev Container CLI](/_implementors/reference.md):

     ```bash
     npm install -g @devcontainers/cli
     ```

* Build your image and push it to a container registry (like the [Azure Container Registry](https://learn.microsoft.com/azure/container-registry/container-registry-get-started-docker-cli?tabs=azure-cli), [GitHub Container Registry](https://docs.github.com/packages/working-with-a-github-packages-registry/working-with-the-container-registry#pushing-container-images), or [Docker Hub](https://docs.docker.com/engine/reference/commandline/push)):

     ```bash
     devcontainer build --workspace-folder . --push true --image-name <my_image_name>:<optional_image_version>
     ```

* You can automate pre-building your image by scheduling the build using a DevOps or continuous integration (CI) service like GitHub Actions. We've created a [GitHub Action](https://github.com/marketplace/actions/devcontainers-ci) and [Azure DevOps task](https://marketplace.visualstudio.com/items?itemName=devcontainers.ci) to help with this.

**Using a prebuilt image:**
* Determine the published URL of the prebuilt image you want to use
* Reference it in your devcontainer.json, Dockerfile, or Docker Compose file

**Note:** In our previous guide on ["Using Images, Dockerfiles, and Docker Compose,"](/_posts/2022-12-16-dockerfile.md) we also showed how you can use prebuilt images, Dockerfiles, or Docker Compose files for your configurations.

## <a href="#example" name="example" class="anchor"> Example </a>

Let's use Craig's Kubernetes dev container as an example.

**Prebuilding the image:**
// TODO

**Using the prebuilt image:**
// TODO

### <a href="#labels" name="labels" class="anchor"> Metadata in image labels</a> 

// TODO - bring over info from other doc

## <a href="#tips" name="tips" class="anchor"> Tips and Tricks </a>

// TODO: Get these from Craig during his journey

## <a href="#feedback" name="feedback" class="anchor"> Feedback and Closing </a>

We hope these tips will help you optimize your dev container workflows! We can't wait to hear your tips, tricks, and feedback. How are you prebuilding your images? Would anything make the process easier for you?

If you haven't already, we recommend joining our dev container [community Slack channel](https://aka.ms/dev-container-community) where you can connect with the dev container spec maintainers and community at large. If you have any feature requests or experience any issues as you use any of the above tools, please feel free to also open an issue in the corresponding repo in the [dev containers org](https://github.com/devcontainers) on GitHub.